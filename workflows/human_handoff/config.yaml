# Human Handoff Workflow Configuration
# Converted from agent to workflow for enhanced orchestration

workflow:
  workflow_id: "human-handoff"
  name: "Human Handoff Workflow"
  description: "Orchestrates escalation to human agents with context preservation and notifications"
  version: 1

model:
  provider: "anthropic"
  id: "claude-sonnet-4-20250514"
  temperature: 0.8
  max_tokens: 2000

# Escalation criteria and triggers
escalation_detection:
  frustration_indicators:
    - "droga"
    - "merda" 
    - "porra"
    - "caralho"
    - "desgraÃ§a"
    - "bosta"
    - "inferno"
    - "puta"
    - "cacete"
    - "foda"
  
  explicit_requests:
    - "quero falar com humano"
    - "quero atendente"
    - "falar com pessoa"
    - "atendimento humano"
    - "me transfere"
    - "pessoa real"
    - "nÃ£o quero robÃ´"
    - "chega de robÃ´"
    - "preciso de supervisor"
    - "quero falar com gerente"
  
  caps_threshold: 0.7  # 70% caps = yelling
  
  high_value_threshold: 10000  # R$ 10,000+
  
  complexity_indicators:
    - "fraude"
    - "seguranÃ§a"
    - "investigaÃ§Ã£o"
    - "disputa"
    - "chargeback"
    - "processo"
    - "advogado"

# Protocol generation fields
protocol_fields:
  required:
    - customer_name
    - customer_cpf
    - issue_description
    - escalation_reason
  optional:
    - previous_attempts
    - urgency_level
    - customer_emotion
    - recommended_action
    - value_involved
    - conversation_summary

# WhatsApp notification settings
whatsapp:
  enabled: true
  instance: "pagbank_support"
  notification_template: |
    ğŸš¨ *EscalaÃ§Ã£o para Atendimento Humano*
    
    ğŸ“‹ *Protocolo:* {protocol_id}
    ğŸ‘¤ *Cliente:* {customer_name}
    ğŸ“± *CPF:* {customer_cpf}
    âš ï¸ *Motivo:* {escalation_reason}
    ğŸ• *HorÃ¡rio:* {timestamp}
    
    ğŸ“ *DescriÃ§Ã£o:*
    {issue_description}
    
    ğŸ’¬ *Resumo da Conversa:*
    {conversation_summary}
    
    ğŸ¯ *AÃ§Ã£o Recomendada:*
    {recommended_action}

# Team routing based on issue type
team_routing:
  adquirencia:
    - "antecipaÃ§Ã£o"
    - "mÃ¡quina"
    - "vendas"
    - "recebimento"
  emissao:
    - "cartÃ£o"
    - "limite"
    - "fatura"
    - "bloqueio"
  pagbank:
    - "pix"
    - "conta"
    - "aplicativo"
    - "transferÃªncia"
  general:
    - "fraude"
    - "seguranÃ§a"
    - "disputa"

# Notification targets by team
notification_targets:
  adquirencia: "+5511999999001"
  emissao: "+5511999999002"  
  pagbank: "+5511999999003"
  general: "+5511999999000"  # Supervisor

# Storage configuration
storage:
  type: "postgres"
  table_name: "human_handoff_workflows"
  mode: "workflow"
  auto_upgrade_schema: true

# Workflow behavior
workflow_settings:
  timeout_minutes: 30
  retry_attempts: 3
  enable_context_preservation: true
  generate_handoff_report: true
  notify_completion: true